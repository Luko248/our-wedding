@use '../base/mixins/index' as *;
@use '../base/variables/index' as *;

@mixin create-seating-plan {
    .plan {
        @include padding-set-y(8dvb);
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        inline-size: calc(100% - $gap-l);
        max-inline-size: $width-desktop-s;
        column-gap: clamp($border-width, 1.5dvi, $gap-m);
        row-gap: $gap-l;
        margin-inline: auto;

        @include mq-responsive('mobile-l', max) {
            row-gap: $gap-xl;
        }

        &__top {
            @include flex-set(flex, row, nowrap, 0, center, center, center);
            @include padding-set-y($gap-l);
            position: sticky;
            top: var(--nav-height);
            background-color: var(--nav_bg, hsl(0 0% 100% / 50%));
            z-index: 100;
            backdrop-filter: blur($gap-s);
        }
    }

    .table {
        @include border-set-all($border-width-l);
        @include border-radius(m);
        @include padding-set-all(clamp($gap-xs, 1.5dvi, $gap-m));
        position: relative;
        background-color: var(--table_bg-color, $color-white);
        transition: background-color $trans-time $trans-fnc;

        &:focus-within,
        &:has(.chair--selected) {
            --table_bg-color: #{lighten($color-primary, 35%)};
        }

        &:after {
            position: absolute;
            content: attr(data-title);
            font-family: $font-title;
            font-size: clamp(1rem, 2dvi, $gap-l);
            white-space: nowrap;
        }

        &--main {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            place-items: center;
            aspect-ratio: 7 / 1.25;
            grid-column-end: span 7;

            &:after {
                bottom: calc(100% + $gap-m);
                left: 50%;
                translate: -50%;
            }
        }

        &:not(.table--main) {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            place-items: center;
            align-items: stretch;
            gap: clamp($gap-m, 2dvi, $gap-l);

            &:after {
                top: $gap-3xl;
                left: calc(100% + $gap-m);
                writing-mode: vertical-rl;

                @include mq-responsive('mobile-l', max) {
                    top: 0;
                    left: 50%;
                    writing-mode: initial;
                    translate: -50% calc(-100% - $gap-s);
                }
            }
        }

        &--1 {
            grid-column: 1 / 2;
        }

        &--2 {
            grid-column: 4 / 5;
        }

        &--3 {
            grid-column: 7 / 8;
        }
    }

    .chair {
        --chair_bg-color: #{$color-secondary};
        --chair_border-color: #{$color-transparent};
        @include border-radius(circle);
        position: relative;
        display: grid;
        place-items: center;
        inline-size: clamp($gap-xl, 5dvi, $gap-3xl);
        block-size: clamp($gap-xl, 5dvi, $gap-3xl);
        background-color: var(--chair_bg-color);
        border-width: 0;
        font-family: $font-text;
        font-size: clamp($gap-m, 3dvi, $gap-l);
        color: $color-white;
        z-index: 1;

        &--selected {
            --chair_bg-color: #{$color-primary};
        }

        @include mq-hover {
            &:not(.chair--selected) {
                --chair_bg-color: grey;
            }
        }

        &:not(.chair--selected):focus {
            --chair_bg-color: grey;
        }

        &:before {
            content: attr(data-number);
            font-weight: 300;
        }
    }
}